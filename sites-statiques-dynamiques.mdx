---
title: 'Les sites statiques et dynamiques et Next.js'
date: '2023-12-05'
summary: 'test'
tags: ['next.js']
---

Un des avantages d'utiliser un framework comme Next.js par rapport √† du React.js pur, c'est de pouvoir b√©n√©ficier du *"Server-Side Rendering"* (SSR), c'est-√†-dire un rendu des pages s'effectuant c√¥t√© serveur. En effet, l√† o√π une page web statique est g√©n√©r√©e via le navigateur web de l'utilisateur, par exemple lorsqu'il interagit avec des composants front-end, le SSR permet de pr√©-rendre ces pages du c√¥t√© serveur avant de les envoyer au navigateur. Les avantages sont nombreux, notamment en termes de SEO, mais nous y reviendrons apr√®s avoir pos√© les fondamentaux.


# Les fondamentaux : pages web statiques et dynamiques

Pour bien comprendre ce m√©canisme et ses subtilit√©s, il faut revenir au fondamentaux. A commencer par bien comprendre la diff√©rence entre une page web statique et dynamique (oui, les fondamentaux on a dit ! üòÖ)

- Une page web **statique**, c'est une page (typiquement compos√©e de HTML, CSS et JS) qui est d√©j√† disponible sur le serveur dans la forme dans laquelle elle sera servie √† l'utilisateur. En se rendant sur l'URL, l'utilisateur envoie une requ√™te au serveur pour acc√©der √† cette page, et le serveur lui renvoie exactement cette page (constitu√©e par exemple de HTML, CSS et JS), sans effectuer aucune √©tape interm√©diaire.

- Une page web **dynamique**, vous l'aurez devin√©, c'est son antagoniste. Avant que l'utilisateur n'effectue √† travers son navigateur la demande pour se rendre sur une page dynamique, la page telle qu'elle va √™tre servie √† l'utilisateur n'existe pas sur le serveur. Au moment de la requ√™te, le serveur va r√©cup√©rer diverses informations sur une (ou plusieurs) bases de donn√©es pour construire une page web "unique", puis l'envoyer √† l'utilisateur. Son navigateur va ensuite l'afficher. 

Il est crucial ici de bien comprendre le sens de *statique*. Dire qu'une page est statique ne veut pas dire qu'elle n'est pas dot√©e d'interactions. Au contraire ! Un bouton qui affiche ou cache du contenu, un formulaire de contact qui envoie un e-mail, un appel vers une API pour r√©cup√©rer la m√©t√©o et l'afficher √† l'√©cran‚Ä¶ sont tant de choses que l'on peut effectuer sur une page statique. 

La diff√©rence, c'est qu'une page web statique est servie √† l'utilisateur dans un √©tat qui n'est potentiellement pas "final" : la navigateur va devoir √©ventuellement s'occuper de r√©cup√©rer des donn√©es apr√®s le rendu initial de la page, avec JavaScript par exemple. C'est typiquement ce qu'il se passe quand on voit une partie d'une page charger avec un *"spinner"* (le demi cercle qui tourne).

Une page web dynamique, elle, est fournie √† l'utilisateur dans son √©tat final, parce que ce processus de g√©n√©ration de la page a eu lieu sur le serveur. C'est √ßa, le SSR ! Avoir un site web qui dispose de pages dynamiques n√©cessite donc la pr√©sence d'un backend.

C'est assez facile de s'emm√™ler les pinceaux avec ces concepts, car la terminologie est assez contre-intuitive, il faut l'avouer.

Ainsi, une web-app React.js qui effectue des appels vers une API et dont le contenu de la page change en fonction de plusieurs param√®tres est-elle dynamique ou statique ? Eh bien elle est statique, car m√™me si son contenu change dynamiquement au sein du navigateur, ce qui est *servi* au navigateur par le serveur est bel et bien statique : il n'y a pas de rendu au pr√©alable, la m√™me chose est servie √† tous les utilisateurs. Vous saisissez ?

# Statique vs dynamique : qu'est-ce qui est mieux ?

Un site web statique est plus simple √† mettre en place, mais n√©cessite un rendu par le navigateur et peut poser des probl√®mes de s√©curit√© (code JavaScript disponible publiquement). Un site web dynamique √©limine ces probl√®mes, mais la page doit √™tre g√©n√©r√©e c√¥t√© serveur d'abord, ce qui implique la cr√©ation d'un backend et son d√©ploiement, c'est-√†-dire un serveur supportant le langage serveur choisi, l√† o√π un site statique n'aura besoin que d'un h√©bergement statique. Cela va donc d√©pendre de vos besoins, de votre budget (un h√©bergement dynamique est en g√©n√©ral plus cher), de vos connaissances en mati√®re de d√©veloppement ou du prix que vous √™tes pr√™t √† payer d√©veloppeur pour s'en occuper pour vous.

Un autre atout notable du SSR est le **r√©f√©rencement** (le SEO pour *Search Engine Optimization* est un domaine √† part enti√®re). En effet, la pr√©sence de votre site web dans les r√©sultats de recherche Google, Bing etc. et donc votre impact sur votre march√© cible d√©pend d'un processus effectu√© par des robots qu'on appelle des *web crawlers* qui consiste √† sonder le web dans son ensemble afin de r√©f√©rencer les diff√©rents sites et leurs contenus. Si vous avez bien compris le concept derri√®re les pages statiques, vous savez maintenant que le contenu d'une page statique n'est pas initialement disponible lorsque la page est charg√©e mais qu'il d√©pend de la capacit√© du navigateur √† g√©n√©rer la page. Eh bien, ces robots ne sont pas particuli√®rement friands du SSR puisqu'ils ne sondent que le contenu initialement charg√©. L√† o√π une web-app interne d'entreprise n'aura aucun int√©r√™t √† disposer d'un SEO percutant, c'est une toute autre chose s'il s'agit d'une entreprise, d'un business pour lequel vous souhaitez une bonne visibilit√© sur le web.

# CSR, SSR, SSG, ISR : d√©mystifier des acronymes intimidants

Il existe plusieurs proc√©d√©s pour g√©n√©rer des pages web. Les voici :
- CSR pour *Client-Side Rendering*
- SSR pour *Server-Side Rendering*
- SSG pour *Static Site Generation*
- ISR pour *Incremental Static Regeneration*

Si ces acronymes peuvent √™tre intimidants, la bonne nouvelle, c'est qu'on en a d√©j√† abord√© deux sur quatre.
- En effet, le **Client-Side Rendering** (CSR), c'est ce qu'on a √©voqu√© √† l'instant. C'est le processus consistant √† servir au client des pages web statiques qui vont n√©cessiter le navigateur pour se g√©n√©rer pleinement ;
- De m√™me, le **Server-Side Rendering** (SSR), c'est le processus qui consiste √† g√©n√©rer les pages web c√¥t√© serveur, puis √† les envoyer au navigateur (client) pour les afficher : ce sont les pages dynamiques.

Les deux d√©finitions suivantes d√©coulent en r√©alit√© des pr√©c√©dentes, donc si vous m'avez suivi jusqu'ici, √ßa ne devrait pas √™tre trop difficile √† comprendre.

Le **Static Site Generation** (SSG) n'est autre qu'un SSR qui a lieu lors du *build time*, c'est √† dire lorsque l'on compile le site. Il donne lieu √† des pages g√©n√©r√©es dynamiquement c√¥t√© serveur... mais une seule fois, lors de la compilation. A la diff√©rence du SSR, ces pages ne sont donc pas g√©n√©r√©es √† chaque requ√™te de l'utilisateur. Elles sont belles et bien pr√©sentes sur le serveur ainsi g√©n√©r√©es, et servies telles quelles. Ce sont donc des **pages statiques** !

Pour un blog par exemple, c'est la solution id√©ale, car le contenu d'un article ne change pas ou pas souvent. On n'a donc aucun int√©r√™t √† envoyer une requ√™te au serveur √† chaque fois qu'un utilisateur veut acc√©der √† un article pour lui demander de g√©n√©rer la page, n'est-ce pas ?

Mais un probl√®me se pose, car cela n√©cessite d'effectuer un *rebuild* du site entier √† chaque fois que son contenu est amen√© √† changer. Un nouvel article ajout√© sur le blog ? Il faut recompiler le site dans son int√©gralit√©. Si le site est recompil√© chaque dimanche, et qu'un article est post√© le lundi matin, il faudra attendre 6 jours pour qu'il soit visible sur le site. Si le blog contient de nombreux articles ou s'il s'agit d'un site avec beaucoup de contenu, le *build time* peut √™tre cons√©quent.

Le **Incremental Static Regeneration** (ISR) est la r√©ponse parfaite √† cette probl√©matique. C'est une approche hybride qui permet de jouir des b√©n√©fices du SSG sans avoir √† *rebuild* le site entier, ce qui est tr√®s appr√©ciable pour pouvoir *scaler* un site web en termes de contenu. Seule les pages concern√©es sont r√©g√©n√©r√©es de mani√®re p√©riodique, le reste du *build* ne changeant pas.

  
# Next.js, un framework React pour le web

 Le framework **Next.js**, dont le sous-titre officiel est "The React Framework for the Web", permet et facilite cette approche hybride. C'est un framework pens√© pour le web, pour les sites bas√©s sur le contenu, et n√©cessitant un bon r√©f√©rencement. Pour le site sur lequel vous vous trouvez actuellement, par exemple, c'est le framework que j'ai utilis√©. Il m'a permis d'utiliser le *Server-Side Rendering* l√† o√π c'est n√©cessaire, et de faire appel √† l'*Incremental Static Regeneration* l√† o√π c'√©tait plus pertinent. Ce sera le sujet d'un prochain article, dans lequel je montrerai concr√®tement comment cela fonctionne !